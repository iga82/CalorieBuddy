<!DOCTYPE html>
<html>
  <head>
    <title>{{ title }}</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link rel='stylesheet' href='/bootstrap/css/bootstrap.css' />
    <script src='/javascripts/globals.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  </head>
  <body>
    <h1>{{ title }}</h1>
    <p>Welcome to {{ title }}</p>

  <div>
    <h1 class="calorieTotal" style="color: red;">0</h1>
  </div>

  <div class="itemSelect">
  </div>

  <button class="btn1">Add New Item</button>
  <button class="btn2">Done</button>

  <script>
    $(document).ready(function() {
      var selectHTML = "<div class='input-append'><select class='select'></select>";
      var textInputHTML = "<input class ='input-mini' type='text' "
                            + "id='textInput" + textIndex + "' placeholder='Amount'>";
      var servingHTML = " <span class='add-on'>.00</span></div>"
      $(".btn1").click(function(){
        $('.itemSelect').append(selectHTML + textInputHTML + servingHTML);
        textIndex += 1;
        for(var key in keyword_dictionary){
          $('.select').append("<option>" + key + "</option>");
        }
      });

      $(".btn2").click(function(){
        var total = 0.0;
        // get an array of JSON Objects with the selected options
        var selected_items = $('.select').find(":selected").get();
        // index that loops through the different text boxes
        var loopThroughtTextIndex = 0;
        // loop through the array of selected items
        $.each(selected_items, function(index, value) {
          var textInputName = '#textInput' + loopThroughtTextIndex;
          // increase text input index
          loopThroughtTextIndex += 1;
          // get the value from the text input box and convert into an int
          var textInputField = parseFloat($(textInputName).val());
          if(isNaN(textInputField)){
            textInputField = 0;
          }
          // build up the total
          total += keyword_dictionary[$(value).val()].calories * textInputField;
        });
        $('.calorieTotal').html(total);
      });

    });
  </script>

</html>